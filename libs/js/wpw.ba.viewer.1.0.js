/**
 * 
 * 		!! PREVIEW FILE !!
 * 
 * 
 * 		title:		BEFORE/AFTER VIEWER - jQuery plugin
 * 
 *		author: 	Ovidiu Stefancu
 *					http:www.wpworks.net
 					
 *
 * 		info:		File available at http://codecanyon.net/user/wickedpixel
 * 
 * 		ver:		1.0 : 2011-1-17
 * 
 */

var WPW=WPW||{};(function(b){var a=function(h,g){var c=this;this.cfg=b.extend({},b.fn.wpwBAgallery.defaults,g);this.tb=b(h);this.currentIndex=0;this.currentItem;this.oldItem;this.items=[];this.nrItems=b("img",c.tb).length;this.footer;this.btnNext;this.btnPrev;this.tb.addClass("ba_gallery");this.infoBox=b("<div class='ba_info'><div class='ba_info_bg_l'></div><div class='ba_info_text'></div><div class='ba_info_bg_r'></div></div>");this.container=b("<div class='ba_container'></div>");this.mask=b("<div class='ba_mask'></div>");c.container.css("width",(c.nrItems*c.cfg.width)+"px");c.tb.append(c.mask);c.mask.append(c.container);c.mask.css("width",c.cfg.width+"px");c.mask.css("height",c.cfg.height+"px");b("img",c.tb).each(function(l){var j=b(this);var k=b("<div class='ba_item ba_"+l+"'></div>");c.container.append(k);k.append(j);var m=new WPW.baViewer(k,c,l);c.items.push(m)});if(c.nrItems>1){c.footer=b("<div class='ba_footer'><div class='ba_btn_prev'></div><div class='ba_btn_next'></div></div>");c.tb.append(c.footer);c.footer.css("width",c.cfg.width+"px");c.btnNext=b(".ba_btn_next",c.tb);c.btnPrev=b(".ba_btn_prev",c.tb);c.btnPrev.bind("click",function(){c.currentIndex--;if(c.currentIndex<0){c.currentIndex=c.nrItems-1}e();return false});c.btnNext.bind("click",function(){c.currentIndex++;if(c.currentIndex>c.nrItems-1){c.currentIndex=0}e();return false})}function e(){var k=c.items[c.currentIndex];var j=k.tb;c.currentItem=k;var l="easeInOutExpo";c.itemChangeBegin();c.container.animate({left:-j.position().left},{duration:500,easing:l,step:function(){},complete:function(){c.itemChangeEnd()}})}this.itemChangeEnd=function(){c.oldItem=c.currentItem;c.currentItem.tb.trigger("SHOWBA")};this.itemChangeBegin=function(){if(c.oldItem){c.oldItem.tb.trigger("HIDEBA")}c.checkForInfo()};this.checkForInfo=function(){if(c.currentItem.info){f()}else{d()}};var i=false;function f(){if(!i){i=true;c.infoBox.hide();c.infoBox.fadeIn();if(c.footer){c.footer.append(c.infoBox)}}b(".ba_info_text",c.tb).html(c.currentItem.info)}function d(){if(i){i=false;c.infoBox.fadeOut().detach()}}e()};b.fn.wpwBAgallery=function(c){return this.each(function(){var e=b(this);if(e.data("wpwbagallery")){return}var d=new a(this,c);e.data("wpwbaviewer",d)})};b.fn.wpwBAgallery.defaults={width:700,height:466};b.fn._reverse=[].reverse})(jQuery);WPW.baViewer=function(f,a,h){var g=this;this.tb=f;this.owner=a;var j=true;var n=g.owner.cfg.width;var v=g.owner.cfg.height;this.tb.css("width",n+"px");this.tb.css("height",v+"px");this.img1=$("img:first",g.tb);this.img2;var e=g.img1.attr("alt");var b=g.img1.attr("src");if(!e){e=b;b=""}this.info=g.img1.attr("title");if(b.length<2){return}this.tb.bind("SHOWBA",function(){t()});this.tb.bind("HIDEBA",function(){k()});var m=$('<div class="ba_controller" />');var r=$('<div class="ba_wall" />');var o=$('<div class="ba_door" />');m.data("visRatio",0.5);m.draggable({start:function(){q();m.css("visibility","hidden")},drag:function(){q()},stop:function(){q();m.css("visibility","visible")},axis:"x",containment:g.tb});function q(){var w=m.position();m.data("visRatio",w.left/(n-m.width()));s()}var l=true;function i(){l=false;var w="easeInOutExpo";$(m.data()).delay(500).animate({visRatio:1},{duration:600,step:function(){s()},easing:w,complete:function(){}}).animate({visRatio:0},{duration:600,step:function(){s()},easing:w,complete:function(){}}).animate({visRatio:0.5},{duration:600,step:function(){s()},easing:w,complete:function(){}})}var c=false;var p=false;var u=function(){if(!j&&!p){g.img2=$(new Image());g.img2.load(function(){r.click(function(w){w.preventDefault();w.stopImmediatePropagation();w.stopPropagation();d(w);g.img2.bind("click",function(){return false});return false});onselectstart=function(){return false};p=true;if(l){i()}t()}).error(function(){alert("Error:\nImage not found on this path: "+b);p=true}).attr("src",b)}};var t=function(){if(!p){u()}if(!p){return}if(g.img2){g.img2.prependTo(o)}o.appendTo(g.tb);r.appendTo(g.tb);m.appendTo(g.tb);r.css("width",n+"px");r.css("height",v+"px");o.hide();o.fadeIn();s()};var k=function(){o.fadeOut()};function s(){var w=parseInt(m.data("visRatio")*n);o.css("left",w+"px");o.css("width",n+"px");o.css("height",v+"px");m.css("top",parseInt(v/2)-6+"px");m.css("left",w-parseInt(m.width()/2)+"px");if(g.img2){g.img2.css("left",-w-1+"px")}}function d(x){var z=x.pageX-g.tb.offset().left;var w=z/n;var y="easeInOutExpo";$(m.data()).delay(500).animate({visRatio:w},{duration:600,step:function(){s()},easing:y,complete:function(){}});return false}g.img1.remove();g.img1=$(new Image());g.img1.load(function(){if(j){j=false;g.tb.prepend(g.img1);if(h==g.owner.currentIndex){t()}g.img1.bind("click",function(){return false})}}).error(function(){alert("Error:\nImage not found on this path: "+g.img1.data("img_path"))}).attr("src",e)};
